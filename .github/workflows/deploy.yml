# GitHub Actions å·¥ä½œæµåç§°ï¼Œä¼šæ˜¾ç¤ºåœ¨ Actions é¡µé¢
name: Deploy

# å®šä¹‰è§¦å‘æ¡ä»¶
on:
  workflow_dispatch: { }  # å…è®¸æ‰‹åŠ¨è§¦å‘å·¥ä½œæµï¼ˆåœ¨ GitHub é¡µé¢ç‚¹å‡»è¿è¡Œï¼‰
  push:
    branches:
      - main  # å½“ä»£ç æ¨é€åˆ° main åˆ†æ”¯æ—¶è‡ªåŠ¨è§¦å‘

# å®šä¹‰å·¥ä½œæµæƒé™
permissions:
  contents: write  # æˆäºˆå†™å…¥ä»“åº“å†…å®¹çš„æƒé™ï¼ˆéƒ¨ç½²æ—¶éœ€è¦åˆ›å»º/ä¿®æ”¹æ–‡ä»¶ï¼‰

# å®šä¹‰ä»»åŠ¡
jobs:
  build-and-deploy:  # ä»»åŠ¡åç§°
    # é˜²æ­¢åŒä¸€åˆ†æ”¯çš„å¤šä¸ªå·¥ä½œæµåŒæ—¶è¿è¡Œï¼Œé¿å…éƒ¨ç½²å†²çª
    concurrency: ci-${{ github.ref }}
    
    # æŒ‡å®šè¿è¡Œç¯å¢ƒä¸ºæœ€æ–°ç‰ˆ Ubuntu
    runs-on: ubuntu-latest
    
    # ç­–ç•¥çŸ©é˜µï¼šå¯ä»¥åœ¨å¤šä¸ªç‰ˆæœ¬ä¸Šæµ‹è¯•ï¼ˆè¿™é‡Œåªç”¨ä¸€ä¸ªç‰ˆæœ¬ï¼‰
    strategy:
      matrix:
        node-version: [ 24 ]  # ä½¿ç”¨ Node.js 24 ç‰ˆæœ¬ï¼Œä¸æœ¬åœ°ç¯å¢ƒä¿æŒä¸€è‡´
    
    # æ‰§è¡Œæ­¥éª¤
    steps:
      # æ­¥éª¤ 1ï¼šæ£€å‡ºä»£ç 
      - name: Checkout ğŸ›ï¸
        uses: actions/checkout@v3  # ä½¿ç”¨å®˜æ–¹ checkout action
        with:
          fetch-depth: 0  # è·å–å®Œæ•´çš„ git å†å²è®°å½•ï¼ˆæŸäº›æ„å»ºå·¥å…·å¯èƒ½éœ€è¦ï¼‰
      
      # æ­¥éª¤ 2ï¼šè®¾ç½® Bun ç¯å¢ƒ
      - name: Setup Bun âš¡ï¸
        uses: oven-sh/setup-bun@v1  # ä½¿ç”¨å®˜æ–¹ Bun setup action
        with:
          bun-version: latest  # å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„ Bun
      
      # æ­¥éª¤ 3ï¼šè®¾ç½® Node.js ç¯å¢ƒ
      - name: Use Node.js ${{ matrix.node-version }}
        uses: actions/setup-node@v3  # ä½¿ç”¨å®˜æ–¹ Node.js setup action
        with:
          node-version: ${{ matrix.node-version }}  # ä½¿ç”¨çŸ©é˜µä¸­å®šä¹‰çš„ Node.js ç‰ˆæœ¬
      
      # æ­¥éª¤ 4ï¼šå®‰è£…é¡¹ç›®ä¾èµ–
      - name: Install dependencies âš¡ï¸
        run: bun install  # ä½¿ç”¨ Bun å®‰è£… package.json ä¸­å®šä¹‰çš„æ‰€æœ‰ä¾èµ–åŒ…
      
      # æ­¥éª¤ 5ï¼šæ„å»ºé¡¹ç›®
      - name: Build ğŸ› ï¸
        run: bun run build  # æ‰§è¡Œæ„å»ºå‘½ä»¤ï¼Œç”Ÿæˆé™æ€æ–‡ä»¶
      
      # æ­¥éª¤ 6ï¼šéƒ¨ç½²åˆ° GitHub Pages
      - name: Deploy ğŸš€
        uses: JamesIves/github-pages-deploy-action@v4  # ä½¿ç”¨ç¬¬ä¸‰æ–¹éƒ¨ç½² action
        with:
          folder: out  # æŒ‡å®šè¦éƒ¨ç½²çš„æ–‡ä»¶å¤¹ï¼ˆæ„å»ºè¾“å‡ºç›®å½•ï¼‰
          branch: gh-pages  # éƒ¨ç½²åˆ° gh-pages åˆ†æ”¯ï¼ˆGitHub Pages é»˜è®¤åˆ†æ”¯ï¼‰
