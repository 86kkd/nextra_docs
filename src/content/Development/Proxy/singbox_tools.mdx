# sing-box é…ç½®ç”Ÿæˆå™¨ä¸å·¥å…·é›†

æœ¬é¡µé¢æä¾› sing-box ç›¸å…³çš„åœ¨çº¿å·¥å…·å’Œèµ„æºã€‚

## åœ¨çº¿é…ç½®ç”Ÿæˆå™¨

æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„åœ¨çº¿é…ç½®ç”Ÿæˆå™¨ï¼Œå¯ä»¥å¸®åŠ©ä½ å¿«é€Ÿåˆ›å»º sing-box çš„æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯é…ç½®ã€‚

### åŠŸèƒ½ç‰¹æ€§

- ğŸ” **è‡ªåŠ¨ç”Ÿæˆå¼ºå¯†ç **ï¼šä¸€é”®ç”Ÿæˆå®‰å…¨çš„å¯†ç å’Œå¯†é’¥
- ğŸ“¦ **æ‰¹é‡é…ç½®ç”Ÿæˆ**ï¼šåŒæ—¶ç”ŸæˆæœåŠ¡å™¨ã€å®¢æˆ·ç«¯ã€Dockerã€Worker é…ç½®
- ğŸ’¾ **ä¸€é”®ä¸‹è½½**ï¼šå°†æ‰€æœ‰é…ç½®æ‰“åŒ…æˆ ZIP æ–‡ä»¶ä¸‹è½½
- ğŸš€ **å®‰è£…è„šæœ¬**ï¼šè‡ªåŠ¨ç”ŸæˆæœåŠ¡å™¨éƒ¨ç½²è„šæœ¬

### ä½¿ç”¨æ–¹æ³•

ç‚¹å‡»ä¸‹é¢çš„æŒ‰é’®æ‰“å¼€é…ç½®ç”Ÿæˆå™¨ï¼š

<a href="/tools/config-generator.html" target="_blank" rel="noopener noreferrer" style={{
  display: 'inline-block',
  padding: '12px 24px',
  backgroundColor: '#667eea',
  color: 'white',
  borderRadius: '8px',
  textDecoration: 'none',
  fontWeight: 'bold',
  marginTop: '20px',
  marginBottom: '20px'
}}>
  ğŸš€ æ‰“å¼€é…ç½®ç”Ÿæˆå™¨ï¼ˆæ–°ç‰ˆï¼‰
</a>

æˆ–è€…ä½¿ç”¨å¤‡ç”¨ç‰ˆæœ¬ï¼š
- æ–°ç‰ˆï¼ˆç®€åŒ–ç‰ˆï¼‰ï¼š`http://localhost:3000/tools/config-generator.html`
- åŸç‰ˆï¼ˆå®Œæ•´ç‰ˆï¼‰ï¼š`http://localhost:3000/tools/singbox-config-generator.html`

### ç”Ÿæˆçš„é…ç½®åŒ…å«

1. **æœåŠ¡å™¨é…ç½®**
   - `config.json` - sing-box æœåŠ¡å™¨é…ç½®æ–‡ä»¶
   - `install.sh` - ä¸€é”®å®‰è£…è„šæœ¬

2. **å®¢æˆ·ç«¯é…ç½®**
   - `client-config.json` - åŒ…å«æ‰€æœ‰èŠ‚ç‚¹çš„å®¢æˆ·ç«¯é…ç½®
   - æ”¯æŒ TUN æ¨¡å¼å’Œ Web UI

3. **Cloudflare Worker**
   - è®¢é˜…æœåŠ¡è„šæœ¬
   - è‡ªåŠ¨åŒ…å«æ‰€æœ‰æœåŠ¡å™¨èŠ‚ç‚¹

4. **Docker Compose**
   - å®¹å™¨åŒ–éƒ¨ç½²é…ç½®
   - åŒ…å«è‡ªåŠ¨è¯ä¹¦ç»­æœŸ

## é…ç½®ç¤ºä¾‹

### åŸºç¡€ Trojan æœåŠ¡å™¨é…ç½®

```json
{
  "log": {
    "level": "info",
    "timestamp": true
  },
  "inbounds": [
    {
      "type": "trojan",
      "tag": "trojan-in",
      "listen": "::",
      "listen_port": 443,
      "users": [
        {
          "name": "user",
          "password": "your-strong-password"
        }
      ],
      "tls": {
        "enabled": true,
        "server_name": "your-domain.com",
        "alpn": ["h2", "http/1.1"],
        "certificate_path": "/path/to/cert.pem",
        "key_path": "/path/to/key.pem"
      }
    }
  ],
  "outbounds": [
    {
      "type": "direct",
      "tag": "direct"
    }
  ]
}
```

### å®¢æˆ·ç«¯é€‰æ‹©å™¨é…ç½®

```json
{
  "outbounds": [
    {
      "type": "selector",
      "tag": "proxy",
      "outbounds": ["auto", "node1", "node2", "direct"],
      "default": "auto"
    },
    {
      "type": "urltest",
      "tag": "auto",
      "outbounds": ["node1", "node2"],
      "url": "https://www.gstatic.com/generate_204",
      "interval": "3m",
      "tolerance": 50
    }
  ]
}
```

## å¿«é€Ÿéƒ¨ç½²è„šæœ¬

### ä¸€é”®å®‰è£… sing-box

```bash
# Debian/Ubuntu
bash <(curl -fsSL https://sing-box.app/deb-install.sh)

# ä½¿ç”¨ Docker
docker run -d \
  --name sing-box \
  --restart always \
  --network host \
  -v /etc/sing-box:/etc/sing-box \
  ghcr.io/sagernet/sing-box \
  run -c /etc/sing-box/config.json
```

### è¯ä¹¦ç”³è¯·

```bash
# å®‰è£… certbot
apt install -y certbot

# ç”³è¯·è¯ä¹¦
certbot certonly --standalone \
  -d your-domain.com \
  --email your@email.com \
  --agree-tos \
  --non-interactive
```

## ç›¸å…³æ•™ç¨‹

- [Trojan å¤šèŠ‚ç‚¹éƒ¨ç½²æ•™ç¨‹](/Development/Web/trojan_subscription_setup)
- [èŠ‚ç‚¹åˆ‡æ¢é…ç½®æŒ‡å—](/Development/singbox_node_switching)
- [å¤šç”¨æˆ·ç®¡ç†æ–¹æ¡ˆ](/Development/singbox_multi_user_management)
- [æœåŠ¡ç«¯æ­å»ºä¸ UI ç®¡ç†](/Development/singbox_server_and_ui_guide)

## å¸¸ç”¨å‘½ä»¤

### æœåŠ¡ç®¡ç†

```bash
# å¯åŠ¨æœåŠ¡
systemctl start sing-box

# åœæ­¢æœåŠ¡
systemctl stop sing-box

# é‡å¯æœåŠ¡
systemctl restart sing-box

# æŸ¥çœ‹çŠ¶æ€
systemctl status sing-box

# æŸ¥çœ‹æ—¥å¿—
journalctl -u sing-box -f
```

### é…ç½®æ£€æŸ¥

```bash
# éªŒè¯é…ç½®æ–‡ä»¶
sing-box check -c /etc/sing-box/config.json

# æ ¼å¼åŒ–é…ç½®æ–‡ä»¶
sing-box format -c /etc/sing-box/config.json > formatted.json
```

## æ€§èƒ½ä¼˜åŒ–

### TCP ä¼˜åŒ–

```bash
# æ·»åŠ åˆ° /etc/sysctl.conf
net.core.default_qdisc=fq
net.ipv4.tcp_congestion_control=bbr
net.ipv4.tcp_fastopen=3
net.ipv4.tcp_syncookies=1
net.ipv4.tcp_tw_reuse=1
net.ipv4.tcp_fin_timeout=30
net.ipv4.tcp_max_syn_backlog=8192

# åº”ç”¨é…ç½®
sysctl -p
```

### æ–‡ä»¶æè¿°ç¬¦é™åˆ¶

```bash
# æ·»åŠ åˆ° /etc/security/limits.conf
* soft nofile 65535
* hard nofile 65535
```

## æ•…éšœæ’æŸ¥

### å¸¸è§é—®é¢˜

1. **ç«¯å£è¢«å ç”¨**
   ```bash
   lsof -i :443
   kill -9 $(lsof -t -i:443)
   ```

2. **è¯ä¹¦è¿‡æœŸ**
   ```bash
   # æ‰‹åŠ¨ç»­æœŸ
   certbot renew
   
   # è®¾ç½®è‡ªåŠ¨ç»­æœŸ
   crontab -e
   # æ·»åŠ : 0 2 * * * certbot renew --quiet
   ```

3. **TUN æ¨¡å¼æƒé™**
   ```bash
   # Linux
   sudo setcap cap_net_admin=eip /usr/local/bin/sing-box
   
   # æˆ–ä½¿ç”¨ root è¿è¡Œ
   sudo sing-box run -c config.json
   ```

## å®‰å…¨å»ºè®®

- âœ… ä½¿ç”¨å¼ºå¯†ç ï¼ˆ16ä½ä»¥ä¸Šéšæœºå­—ç¬¦ï¼‰
- âœ… å®šæœŸæ›´æ–° sing-box ç‰ˆæœ¬
- âœ… å¯ç”¨è¯ä¹¦è‡ªåŠ¨ç»­æœŸ
- âœ… é™åˆ¶ SSH è®¿é—®
- âœ… ä½¿ç”¨é˜²ç«å¢™é™åˆ¶ç«¯å£
- âœ… ç›‘æ§æœåŠ¡å™¨æ—¥å¿—
- âœ… å®šæœŸå¤‡ä»½é…ç½®æ–‡ä»¶

## æ›´å¤šèµ„æº

- [sing-box å®˜æ–¹æ–‡æ¡£](https://sing-box.sagernet.org/)
- [GitHub ä»“åº“](https://github.com/SagerNet/sing-box)
- [Telegram ç¾¤ç»„](https://t.me/sing_box)
